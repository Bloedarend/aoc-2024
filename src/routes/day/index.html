<!doctype html>
<html lang="en">
    <head>
        <title>Advent of Code - {{name}}</title>
        <link rel="icon" href="/assets/favicon.png">

        <link rel="stylesheet" href="../app.css">
        <script src="https://cdn.jsdelivr.net/npm/@heppokofrontend/html-code-block-element/lib/html-code-block-element.common.min.js" defer ></script>
    </head>
    <body>
        <header>
            <div class="row" style="flex-grow: 1;">
                <span class="star">*</span>
                <h1 id="title">Advent of Code {{year}}</h1>
            </div>
            <div class="row">
                <a class="btn row" style="line-height: 0" href="{{repository}}">
                    <img src="/assets/github-icon.svg" alt="github" height="24rem" width="24rem" />
                    <span style="margin-top: 0.1rem;">{{name}}</span>
                </a>
            </div>
        </header>
        <main>
            <div class="row-to-col">
                <div class="col w-70-to-100">
                    <h2>Solution</h2>
                    <code-block id="code" class="typescript"></code-block>
                </div>
                <div class="col w-30-to-100">
                    <div class="row">
                        <h2 style="flex-grow: 1;">Output</h2>
                        <button class="secondary">Run</button>
                    </div>
                    <code-block id="console" class="bash"></code-block>
                </div>
            </div>
        </main>

        <script defer async type="module">
            import { transpileModule } from 'https://esm.sh/typescript';

            console.log = (message) => {
                const div = document.createElement("div");
                div.textContent = message;
                document.body.append(div);
            }

            const day = parseInt(window.location.pathname.split("/").findLast(() => true));
            if (!Number.isInteger(day) || day < 1 || day > 25) {
                window.location.href = "/";
            }

            const input = await (await fetch(`/solutions/${day}/input.txt`)).text();
            const typescript = await (await fetch(`/solutions/${day}/main.ts`)).text();
            const javascript = transpileModule(
                typescript.replace(/^const input = .*/m, `const input = \`${input}\`;`),
                { compilerOptions: { module: "ESNext" } }
            ).outputText;

            const codeContainer = document.querySelector('#code');
            if (codeContainer) {
                // codeContainer.textContent = typescript;
            }
        </script>
    </body>
</html>
